<html layout:decorate="~{layout/default}">
<head>
    <!-- 추가된 부분 -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script>
        $(document).ready(function () {
            $('#selectWorkScheduleDate').on('input', function () {
                var selectedDate = $(this).val();

                // Ajax 요청 수행
                $.ajax({
                    type: "POST",
                    url: "/hr/workSchedule/create",
                    data: { selectedDate: selectedDate },
                    success: function (data) {
                        // 성공적으로 데이터를 받아왔을 때 부분 업데이트 수행
                        $('#dataTable').html(data);
                    },
                    error: function (error) {
                        console.log("Error:", error);
                    }
                });
            });
        });
    </script>
</head>>
<body>
<div layout:fragment="content" class="container-fluid">
    <div class="card shadow mb-4">
        <div class="card-body">
            <form class="formEntry" th:action="@{/hr/workSchedule/create}" th:object="${workScheduleForm}"
                  method="post" onsubmit="submitForm(event)">
                <div class="form-group row">
                    <label for="selectWorkScheduleDate" class="col-sm-2 col-form-label">일자</label>
                    <div class="col-sm-4">
                        <input type="date" class="form-control" id="selectWorkScheduleDate">
                    </div>
                </div>
            </form>
            <!-- DataTales Example -->
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">출퇴근 정보</h6>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                            <thead class="table-dark">
                            <tr>
                                <th>날짜</th>
                                <th>부서</th>
                                <th>이름</th>
                                <th>출근시간</th>
                                <th>퇴근시간</th>
                            </tr>
                            </thead>
                            <tbody th:fragment="workScheduleTable">
                            <tr th:each="work : ${workScheduleList}">
                                <td th:text="${work.workScheduleDate}"></td>
                                <td th:text="${work.empInfoEntity.departEntity.departNm}"></td>
                                <td th:text="${work.empInfoEntity.empInfoNm}" th:classappend="${work.workScheduleCheck} ? 'text-danger' : ''"></td>
                                <td th:text="${work.workScheduleStartTime}"></td>
                                <td th:text="${work.workScheduleEndTime}"></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
</body>
</html>
