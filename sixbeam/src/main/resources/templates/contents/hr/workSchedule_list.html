<html layout:decorate="~{layout/default}">
<head>
    <!-- 추가된 부분 -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script>
        $(document).ready(function () {
            // input type="date"의 값이 변경되었을 때 동작할 함수
            $('#selectWorkScheduleDate').on('input', function () {
                // 선택된 날짜 가져오기
                var selectedDate = $(this).val();

                // 폼 데이터 생성
                var formData = {
                    selectedDate: selectedDate
                };

                // 폼에 데이터 추가
                for (var key in formData) {
                    if (formData.hasOwnProperty(key)) {
                        var input = document.createElement("input");
                        input.type = "hidden";
                        input.name = key;
                        input.value = formData[key];
                        document.querySelector(".formEntry").appendChild(input);
                    }
                }

                // 페이지 새로고침 (폼이 제출됨)
                // 여기서는 이벤트를 중지시켜 실제로 폼이 서버로 전송되지 않도록 합니다.
                event.preventDefault();
                document.querySelector(".formEntry").submit();
            });
        });
    </script>
</head>>
<body>
<div layout:fragment="content" class="container-fluid">
    <div class="card shadow mb-4">
        <div class="card-body">
            <form class="formEntry" th:action="@{/hr/workSchedule/create}" th:object="${workScheduleForm}"
                  method="post" onsubmit="submitForm(event)">
                <div class="form-group row">
                    <label for="selectWorkScheduleDate" class="col-sm-2 col-form-label">일자</label>
                    <div class="col-sm-4">
                        <input type="date" class="form-control" id="selectWorkScheduleDate">
                    </div>
                </div>
            </form>
            <!-- DataTales Example -->
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">출퇴근 정보</h6>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                            <thead>
                            <tr>
                                <th>날짜</th>
                                <th>부서</th>
                                <th>이름</th>
                                <th>출근시간</th>
                                <th>퇴근시간</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr th:each="work : ${workScheduleList}">
                                <td th:text="${work.workScheduleDate}"></td>
                                <td th:text="${work.empInfoEntity.departEntity.departNm}"></td>
                                <td th:text="${work.empInfoEntity.empInfoNm}" th:classappend="${work.workScheduleCheck} ? 'text-danger' : ''"></td>
                                <td th:text="${work.workScheduleStartTime}"></td>
                                <td th:text="${work.workScheduleEndTime}"></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
</body>
</html>
